# 동적 디스패치를 줄여 성능 향상

다른 언어들과 마찬가지로 Swift는 오버라이드 기능이 제공됩니다. 이 오버라이드 기능은 메서드 또는 속성을 런타임에 결정한 다음 호출 또는 엑세스를 수행하는 방식으로 작동 됩니다. 이 기술을 **동적 디스패치(Indirect Call)**라고 합니다. 이 기술은 각 간접 사용에 대해 일정한 양의 런타임 오버 헤드를 발생하는 대신 언어 표현력을 향상시킵니다. 성능에 민감한 코드에서 이러한 오버헤드는 종종 바람직하지 않습니다. 오버헤드를 줄여 성능을 향상 시키는 세가지 방법인 final, private, Whole Module Optimization에 대해 정리 해보겠습니다.

## 성능을 향상 시키는 방법

1. 오버라이드 될 필요가 없는 요소들에는 final 키워드를 붙이세요. 

final 키워들 붙여서 선언된 클래스, 메소드, 프로퍼티는 오버라이드 할 수 없게 됩니다. 이를 통해 동적 디스패치를 사용하지 않게 되고 성능을 향상 시킬 수 있습니다.


2. private 키워드를 적용하여 한 파일에서 참조 되는 선언에 대해 final을 추론 하십시오.

선언에 private 키워드를 적용하게 되면 해당 요소는 선언의 가시성이 현재 파일로 제한됩니다. (예를 들어 private method는 외부 파일에서 볼 수 없음) 이를 통해 컴파일러는 오버라이드 되는 모든 선언을 찾을 수 있습니다. 오버라이드 선언이 없으면 컴파일러가 final 키워드를 자동으로 유추하고 메서드 및 속성 엑세스에 대한 간접 호출을 제거할 수 있습니다. 따라서 한 파일내에 해당 요소에 대한 오버라이드가 없는 경우 컴파일러가 이를 자동으로 Direct Call(정적 디스패치)로 바꿔줄 수 있습니다.

- -> private 키워드를 적용하면 컴파일러는 오버라이드 되는 선언만 찾을 수 있게 되며 오버라이드 선언이 없으면 컴파일러가 final 키워드를 자동으로 유추함

3. WMO(Whole Module Optimization)를 사용 하여 내부 선언에 대한 최종 추론을 합니다.
internal로 선언하면 모듈 내에서만 볼 수 있습니다. Swift는 일반적으로 모듈을 구성하는 팔일을 개별적으로 컴파일하기 때문에 internal 선언이 다른 파일에서 오버라이드 되었는지 여부를 확인할 수 없습니다. 그러나 WMO가 활성화 된 경우 모든 모듈이 동시에 함께 컴파일 됩니다. 이를 통해 컴파일러는 전체 모듈에 대한 추론을 함께 수행하고 가시적인 오버라이드가 없는 경우 internal 선언에 의해 final 키워드를 유추 할 수 있습니다.

## 내용 출처

[Increasing Performance by Reducing Dynamic Dispatch 애플 공식 문서](https://developer.apple.com/swift/blog/?id=27)